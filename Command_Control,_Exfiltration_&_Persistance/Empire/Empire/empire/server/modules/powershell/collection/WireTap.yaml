name: Invoke-WireTap
authors:
  - '@mDoi12mdjf'
  - '@S3cur3Th1sSh1t'
description: 'WireTap is a .NET 4.0 project to consolidate several functions used
  to interact with a user''s hardware, including: Screenshots (Display + WebCam Imaging),
  Audio (Both line-in and line-out), Keylogging, & Activate voice recording when the
  user says a keyword phrase. Note: Only one method can be ran at a time.'
software: ''
techniques:
  - T1123
  - T1125
  - T1056
background: false
output_extension:
needs_admin: false
opsec_safe: true
language: powershell
min_language_version: '4'
comments:
  - https://github.com/djhohnstein/WireTap
options:
  - name: Agent
    description: Agent to run on.
    required: true
    value: ''
  - name: record_mic
    description: Record audio from the attached microphone (line-in).
    required: false
    value: 'True'
  - name: record_sys
    description: Record audio from the system speakers (line-out).
    required: false
    value: ''
  - name: record_audio
    description: 'Record audio from both the microphone and the speakers. Default: 10s'
    required: false
    value: ''
  - name: capture_screen
    description: Screenshot the current user's screen.
    required: false
    value: ''
  - name: capture_webcam
    description: Capture images from the user's attached webcam (if it exists).
    required: false
    value: ''
  - name: keylogger
    description: Begin logging keystrokes to a file.
    required: false
    value: ''
  - name: listen_for_passwords
    description: Listens for words 'username', 'password', 'login' and 'credential',
      and when heard, starts an audio recording for two minutes.
    required: false
    value: ''
  - name: time
    description: Time to record mic, sys, or audio. Time suffix can be s/m/h.
    required: false
    value: 10s
advanced:
  custom_generate: true