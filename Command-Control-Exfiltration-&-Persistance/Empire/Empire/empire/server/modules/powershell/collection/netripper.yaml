name: Invoke-NetRipper
authors:
  - Ionut Popescu (@NytroRST)
  - '@mattifestation'
  - '@harmj0y'
description: Injects NetRipper into targeted processes, which uses API hooking in
  order to intercept network traffic and encryption related functions from a low privileged
  user, being able to capture both plain-text traffic and encrypted traffic before
  encryption/after decryption.
software: ''
techniques:
  - T1179
  - T1410
background: true
output_extension:
needs_admin: false
opsec_safe: false
language: powershell
min_language_version: '2'
comments:
  - https://github.com/NytroRST/NetRipper/
options:
  - name: Agent
    description: Agent to run module on.
    required: true
    value: ''
  - name: ProcessID
    description: Specific process ID to inject the NetRipper dll into.
    required: false
    value: ''
  - name: ProcessName
    description: Inject the NetRipper dll into all processes with the given name (i.e.
      putty).
    required: false
    value: ''
  - name: LogLocation
    description: Folder location to log sniffed data to.
    required: false
    value: TEMP
  - name: AllData
    description: Switch. Log all data instead of just plaintext.
    required: false
    value: ''
  - name: Datalimit
    description: Data limit capture per request.
    required: false
    value: '4096'
  - name: SearchStrings
    description: Strings to search for in traffic.
    required: true
    value: user,login,pass,database,config
script_path: 'empire/server/data/module_source/collection/Invoke-NetRipper.ps1'
script_end: Invoke-NetRipper {{ PARAMS }}